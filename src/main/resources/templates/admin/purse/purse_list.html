<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/static/css/bootstrap.min.css" />
	<link rel="stylesheet" href="/static/css/bootstrap-responsive.min.css" />
	<link rel="stylesheet" href="/static/css/matrix-style.css" />
	<link rel="stylesheet" href="/static/css/matrix-media.css" />
	<link rel="stylesheet" href="/static/font-awesome/css/font-awesome.css" />
	<!-- 实现左边动画 -->
	<script type="text/javascript" src="/static/js/jquery-3.1.1.min.js"></script>

	<script src="/static/js/matrix.js"></script>
	<!-- 实现上边动画 -->
	<script type="text/javascript" src="/static/js/bootstrap.js"></script>
<style>
.modal-header {
	text-align: center;
}

table td {
	text-align: center;
	border: 0px;
}
</style>
<title>钱包列表</title>
<!-- 分页 -->
<link href="/static/css/mypage.css" rel="stylesheet">

<!--<link href="/static/css/bootstrap.min.css" rel="stylesheet">-->

<link href="/static/css/bootstrap-datetimepicker.min.css" rel="stylesheet">

</head>

<body>
<div th:replace="/admin/main_top :: top "></div>
<div th:replace="/admin/main_left :: left "></div>
	<!--=============================================================================================================================================================================-->
	<!--main-container-part-->
	<div id="content" style="margin-right: 100px; margin-top: 40px;">
		<!--breadcrumbs-->
		<div id="content-header">
			<div id="breadcrumb">
				<a href="/admin/index" title="主页" class="tip-bottom"><i
					class="icon-home"></i>主页</a> <a title="充值列表" class="tip-bottom">充值钱包</a>
			</div>
		</div>
		<!--End-breadcrumbs-->

		<!-- Page table -->
		<div class="container" style="width: 1000px;">
			<!-- &lt;!&ndash; Marketing Icons Section &ndash;&gt;-->

			<div class="col-lg-12">
				<h2 class="page-header"
					style="margin-top: 10px; text-align: center; font-family: '微软雅黑', Verdana, sans-serif, '宋体', serif;">
					钱包列表显示</h2>
			</div>

			<!--搜索栏-->
			<form class="form-horizontal" id="myserchform" name="myform"
				action="/admin/searchPurse" method="post">
				<div class="form-group">
					<div class="col-sm-5" style="text-align: center;">
						<input type="number" placeholder="请输用户id" name="userId" th:value="${searchpurse!=null?searchpurse.userId:''}" class="form-control"/>
					</div>
					<div class="col-sm-5" style="text-align: left;">
					<select name="state" data-style="btn-info" class="form-control" id="myselected">
					<option value="" >请选择审核状态</option>
					<option value="0">尚未审核</option>
					<option value="1">审核失败</option>
					<option value="2">审核成功</option>
					</select>
					</div>
					<div class="col-sm-2">
						<button class="btn btn-success btn-default" type="submit">查找</button>
						<!-- <button class="btn btn-danger btn-sm" type="button" id="deletePurseButton">删除</button>  -->
					</div>
				</div>
			</form>

			<!--表格显示-->
			<table class="table table-bordered">
				<thead>
					<tr>
						<!-- <th><input type="checkbox" id="selectAllButton"></th> -->
						<!-- <th>ID</th> -->
						<th>用户ID</th>
						<th>当前金额</th>
						<th>充值金额</th>
						<th>提现金额</th>
						<th>状态</th>
						<th>操作</th>
					</tr>
				</thead>
				<tbody>
						<tr th:each="item:${purseGrid.rows}">
							<td><span th:text="${item.userId}"></span></td>
							<td><span th:text="${item.balance}"></span></td>
							<td><span th:text="${item.recharge}"></span></td>
							<td><span th:text="${item.withdrawals}"></span></td>
							<td>
							<span th:if="${item.state} eq null">-</span>
							<span th:if="${item.state} eq 0" class="btn-primary btn-info">尚待审核</span>
							<span th:if="${item.state} eq 1" class="btn-primary btn-danger">审核失败</span>
							<span th:if="${item.state} eq 2" class="btn-primary  btn-success">审核成功</span>
							</td>
							<td th:switch="${item.state}">
							   <button th:case="null" type="button" class="btn btn-primary" >无需审核</button>
							   <button th:case="0" type="button" class="btn btn-info" onclick="doEdit(${item.id})">立即审核</button>
							   <button th:case="*" type="button" class="btn btn-success" >已经审核</button>
							</td> 
						</tr>
				</tbody>
			</table>

			<!--分页条-->
			<div style="text-align: right">
				<div class="pagination">
					<ul>
						<li><a>总钱包数:<span th:text="${purseGrid.total }"></span>个</a></li>
						<li><a>第<span th:text="${purseGrid.current }"></span>页</a></li>
							<li th:if="${purseGrid.current} ne 1"><a th:href="'/admin/purseList?pageNum='+${purseGrid.current-1 }">上一页</a>
							</li>
							<li th:if="${purseGrid.current}<(${purseGrid.total}+9)/10-1"><a
								th:href="'/admin/purseList?pageNum='+${purseGrid.current+1 }">下一页</a>
							</li>
					</ul>
				</div>
			</div>
		</div>
	</div>


	<!--==================================================================================================================-->
<div th:replace="/admin/main_bottom :: bottom"></div>

	<!--修改  模态框（Modal） -->
	<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" id="myModalLabel">审核信息</h4>
				</div>
				<div class="modal-body" style="height: 0 auto;">
					<form class="form-horizontal" id="myeditform" name="myform">
						<input type="hidden" id="id" name="id" value="" />
						<div class="form-group">
							<label class="col-sm-4 control-label">用户ID:</label>
							<div class="col-sm-8">
								<input type="text" readonly class="form-control" name="userId" style="margin-top: 8px;" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">当前金额:</label>
							<div class="col-sm-8">
								<input type="number" class="form-control" name="balance" style="margin-top: 8px;" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">充值金额:</label>
							<div class="col-sm-8">
								<input type="text" readonly class="form-control" name="recharge" style="margin-top: 8px;" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-4 control-label">提现金额:</label>
							<div class="col-sm-8">
								<input type="text" readonly class="form-control" name="withdrawals" style="margin-top: 8px;" />
								<input type="hidden" class="form-control" name="state" style="margin-top: 8px;" />
							</div>
						</div>
					</form>
				</div>

				<div class="modal-footer" >
				<div style="text-align:center">
					<div class="col-sm-2"></div>
					<button type="button" class="btn btn-success col-sm-4" onclick="doSavePass()">通过</button>
					<button type="button" class="btn btn-danger col-sm-4" onclick="doSaveRefuse()">拒绝</button>
				</div>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal -->
	</div>
</body>

<script type="text/javascript" src="/static/js/jquery-3.1.1.min.js"></script>
<script type="text/javascript" src="/static/js/bootstrap.min.js"></script>
<!-- datetimepicker -->
<script type="text/javascript"
	src="/static/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript"
	src='/static/js/bootstrap-datetimepicker.zh-CN.js'></script>
<!-- 全选 base.js -->
<script type="text/javascript" src="/static/js/custom/base.js"></script>
<script type="text/javascript">

	/* 修改 */
	function doEdit(id){
		$.ajax({
			url:'<%=basePath%>admin/getPurse',
			type:'GET',
			data:{id:id},
			dataType:'json',
			success:function(json){
				if(json){
					$('#myeditform').find("input[name='id']").val(json.id);
					$('#myeditform').find("input[name='userId']").val(json.userId);
					$('#myeditform').find("input[name='balance']").val(json.balance);
					$('#myeditform').find("input[name='recharge']").val(json.recharge);
					$('#myeditform').find("input[name='withdrawals']").val(json.withdrawals);
					$('#myeditform').find("input[name='state']").val(json.state);
					$('#editModal').modal('toggle');
				}
			},
			error:function(){
				alert('请求超时或系统出错!');
				$('#editModal').modal('hide');
			}
		});
	}
	
	/* 通过 */
	function doSavePass(){
		$.ajax({
			url:'<%=basePath%>admin/updatePursePass',
			type:'POST',
			data:$('#myeditform').serialize(),// 序列化表单值  
			dataType:'json',
			success:function(json){
				alert(json.msg);
				$('#editModal').modal('toggle');
				location.reload();
			},
			error:function(){
				alert('请求超时或系统出错!');
				$('#editModal').modal('toggle');
			}
		});
	}
	
	/* 不通过 */
	function doSaveRefuse(){
		$.ajax({
			url:'<%=basePath%>admin/updatePurseRefuse',
			type:'POST',
			data:$('#myeditform').serialize(),// 序列化表单值  
			dataType:'json',
			success:function(json){
				alert(json.msg);
				$('#editModal').modal('toggle');
				location.reload();
			},
			error:function(){
				alert('请求超时或系统出错!');
				$('#editModal').modal('toggle');
			}
		});
	}
</script>
<script type="text/javascript" th:inline="javascript">
	//根据值 动态选中
	$("#myselected option[value='[[${searchpurse.state}]]']").attr("selected","selected");
</script>
</html>
